name: Test cURL
on: 
  push:
jobs:
  curl:
    runs-on: ubuntu-latest
    steps:
    - name: Checkout code
      uses: actions/checkout@v3
    - name: Install flask
      run: pip install flask
    - name: Run hello world flask
      run: docker pull digitalocean/flask-helloworld
      
    - name: Run image
      run: docker run -d -p 5000:5000 digitalocean/flask-helloworld
#     - name: Run python script
#       run: cd .github/workflows
#           | pip install flask
#           | nohup python.py < /dev/null & > /dev/null &
    
    - name: Public IP
      id: ip
      uses: haythem/public-ip@v1.2

    - name: Print Public IP
      run: |
        echo ${{ steps.ip.outputs.ipv4 }}
        echo ${{ steps.ip.outputs.ipv6 }}
    - name : check ports
      run: sudo netstat -tunlp
      
    - name: REST API with curl
      run: |
        curl http://0.0.0.0:5000 
   
